function getHiddenProp(){var a=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var i=0;i<a.length;i++)if(a[i]+"Hidden"in document)return a[i]+"Hidden";return null}function isHidden(){var a=getHiddenProp();return!!a&&document[a]}String.prototype.queryStringToJSON=String.prototype.queryStringToJSON||function(){var params=String(this),params=params.substring(params.indexOf("?")+1);if(params=params.replace(/\+/g,"%20"),"{"===params.substring(0,1)&&"}"===params.substring(params.length-1))return eval(decodeURIComponent(params));params=params.split(/\&(amp\;)?/);for(var json={},i=0,n=params.length;i<n;++i){var param=params[i]||null;if(null!==param&&(param=param.split("="),null!==param)){var key=param[0]||null;if(null!==key&&void 0!==param[1]){var value=param[1],key=decodeURIComponent(key),value=decodeURIComponent(value);try{value=eval(value)}catch(a){}var keys=key.split("."),path,cmd;1===keys.length?json[key]=value:(path="",cmd="",$.each(keys,function(ii,key){path+='["'+key.replace(/"/g,'\\"')+'"]',jsonCLOSUREGLOBAL=json,cmd="if ( typeof jsonCLOSUREGLOBAL"+path+' === "undefined" ) jsonCLOSUREGLOBAL'+path+" = {}",eval(cmd),json=jsonCLOSUREGLOBAL,delete jsonCLOSUREGLOBAL}),jsonCLOSUREGLOBAL=json,valueCLOSUREGLOBAL=value,cmd="jsonCLOSUREGLOBAL"+path+" = valueCLOSUREGLOBAL",eval(cmd),json=jsonCLOSUREGLOBAL,delete jsonCLOSUREGLOBAL,delete valueCLOSUREGLOBAL)}}}return json},$.extend($.expr[":"],{inViewport:function(a){var i=document.documentElement.scrollTop||document.body.scrollTop,t=$(a).offset().top,m=$(a).height();return winH=window.innerHeight&&window.innerHeight<$(window).height()?window.innerHeight:$(window).height(),i<t+m&&t<i+winH}});var Gamma=function(){function s(a){Gamma.settings.historyapi||null==a?void 0===a?History.pushState(null,null,url("protocol")+"://"+url("hostname")+url("path")):History.getState().url.queryStringToJSON().id!==a&&History.pushState(null,null,"?id="+a):Gamma.isSV?p(!1,a):p(!0,a)}function i(a){clearTimeout(Gamma.masonrytimeout),a=a||0,Gamma.masonrytimeout=setTimeout(function(){Gamma.gallery.masonry("reload")},a)}function t(a,i,t){t?a.css(t):"on"===i?a.show():a.hide()}function m(a){Gamma.slideshow||w(a)}function e(){v(),y(),Gamma.isSV&&_svResizeImage(),i(200)}var r=$(window),l=$("body"),o=$(document),a=window.Modernizr,g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[a.prefixed("transition")],n={columns:4,speed:300,easing:"ease",overlayAnimated:!0,nextOnClickImage:!0,circular:!0,svImageTransitionSpeedFade:300,svImageTransitionEasingFade:"ease-in-out",svImageTransitionSpeedResize:300,svImageTransitionEasingResize:"ease-in-out",svMarginsVH:{vertical:140,horizontal:120},keyboard:!0,swipe:!0,interval:4e3,historyapi:!0},c=function(){Gamma.container=$("#gamma-container"),Gamma.overlay=Gamma.container.find("div.gamma-overlay"),Gamma.controls=Gamma.container.children("div.gamma-options"),Gamma.gallery=Gamma.container.children("ul.gamma-gallery"),Gamma.items=Gamma.gallery.children(),Gamma.itemsCount=Gamma.items.length,Gamma.columns=Gamma.settings.columns,Gamma.isAnimating=!0,Gamma.svMargins=Gamma.settings.svMarginsVH,!window.History.enabled&&Gamma.settings.historyapi&&(Gamma.settings.historyapi=!1),Gamma.supportTransitions=a.csstransitions},d=function(){1<Gamma.itemsCount&&(Gamma.svplay=$('<button class="gamma-btn-ssplay"></button>').insertAfter(Gamma.svclose),Gamma.nav=$('<nav class="gamma-nav"><span class="gamma-prev"></span><span class="gamma-next"></span></nav>').appendTo(Gamma.singleview),Gamma.svnavnext=Gamma.nav.find("span.gamma-next"),Gamma.svnavprev=Gamma.nav.find("span.gamma-prev"),_initEvents("singleviewnavigation"))},p=function(a,i){Gamma.settings.historyapi&&(i=i||History.getState().url.queryStringToJSON().id);var t,m=null!=i,a=a||!1;Gamma.settings.historyapi&&Gamma.isSV&&void 0===i&&_closesingleview(),!m||(t=Gamma.items.eq(Math.abs(i))).length&&(Gamma.svImage?(Gamma.supportTransitions&&_setTransition(Gamma.svImage,"all",Gamma.settings.svImageTransitionSpeedFade,Gamma.settings.svImageTransitionEasingFade),_applyAnimation(Gamma.svImage,{opacity:0},Gamma.settings.svImageTransitionSpeedFade,Gamma.supportTransitions,function(){$(this).remove(),a=!1,_singleviewitem(t,a)}),Gamma.svDescription&&_applyAnimation(Gamma.svDescription,{opacity:0},400,Gamma.supportTransitions)):(Gamma.svDescription&&Gamma.svDescription.empty(),_singleviewitem(t,a)))},h=function(a){0<Gamma.itemsCount&&(Gamma.singleview?Gamma.nav||d():($('<div class="gamma-single-view"><div class="gamma-options gamma-options-single"><div class="gamma-buttons"><button class="gamma-btn-close"></button></div></div></div>').appendTo(Gamma.container),Gamma.singleview=Gamma.container.children("div.gamma-single-view"),Gamma.svclose=Gamma.singleview.find("button.gamma-btn-close"),_initEvents("singleview"),d())),v(),(a=a||Gamma.items.hide()).each(function(){var a=$(this),i=a.children(),t=G(i),m=f(t,a.outerWidth(!0)),e=i.data("description");a.data({description:e,source:t,maxwidth:i.data("maxWidth"),maxheight:i.data("maxHeight")}),$("<div/>").addClass("gamma-description").html(e).insertAfter(i),$("<img/>").attr({alt:i.data("alt"),title:i.data("title"),src:m.src}).insertAfter(i),i.remove()})},G=function(a){var t=[];return a.children("div").each(function(a){var i=$(this);t.push({width:i.data("minWidth")||0,src:i.data("src"),pos:a})}),t},v=function(){var a=Gamma.container.width();if(Gamma.settings.viewport)for(var i=0,t=Gamma.settings.viewport.length;i<t;++i){var m=Gamma.settings.viewport[i];if(a>m.width){Gamma.columns=m.columns;break}}Gamma.items.css("width",100*Math.floor(a/Gamma.columns)/a+"%")},u=function(a){Gamma.gallery.imagesLoaded(function(){Gamma.gallery.masonry({itemSelector:"li",columnWidth:function(a){return a/Gamma.columns}}),a&&a.call()})},f=function(a,i){i<=0&&(i=1);for(var t=0,m=a.length;t<m;++t){var e=a[t];if(i>e.width)return e}},w=function(a){if(!Gamma.isSV||Gamma.isAnimating)return!1;var i=Gamma.current;if("next"===a?Gamma.current=Gamma.current<Gamma.itemsCount-1?++Gamma.current:Gamma.settings.circular?0:Gamma.current:"prev"===a&&(Gamma.current=0<Gamma.current?--Gamma.current:Gamma.settings.circular?Gamma.itemsCount-1:Gamma.current),i===Gamma.current)return!1;Gamma.isAnimating=!0,s(Gamma.current)},y=function(){Gamma.items.each(function(){var a=$(this),i=f(a.data("source"),Gamma.items.outerWidth(!0));a.find("img").attr("src",i.src)})};return _svResizeImage=function(e){var a=_getFinalImgConfig({sources:Gamma.svImage.data("source"),imgMaxW:Gamma.svImage.data("maxwidth"),imgMaxH:Gamma.svImage.data("maxheight"),wrapper:{width:r.width()-Gamma.svMargins.horizontal,height:r.height()-Gamma.svMargins.vertical},image:{width:Gamma.svImage.width(),height:Gamma.svImage.height()}}),n=a.source,i=a.finalSizePosition,s=Gamma.svImage.attr("src"),t={width:i.width,height:i.height,left:i.left+Gamma.svMargins.horizontal/2,top:i.top+Gamma.svMargins.vertical/2};_applyAnimation(Gamma.svImage,t,Gamma.settings.svImageTransitionSpeedResize,Gamma.supportTransitions,function(){var a,i,t,m;Gamma.supportTransitions&&$(this).off(g),s!==n.src&&(Gamma.isAnimating=!0,a=Gamma.svImage.width(),i=Gamma.svImage.height(),t=Gamma.svImage.position().left,m=Gamma.svImage.position().top,Gamma.svImage=$("<img/>").load(function(){var a=$(this);Gamma.supportTransitions&&_setTransition(a,"all",Gamma.settings.svImageTransitionSpeedResize,Gamma.settings.svImageTransitionEasingResize),_applyAnimation(a.next(),{opacity:0},500,Gamma.supportTransitions,function(){var a=$(this);Gamma.supportTransitions&&$(this).off(g),a.remove(),Gamma.isAnimating=!1})}).css({width:a,height:i,left:t,top:m}).data(Gamma.svImage.data()).insertBefore(Gamma.svImage).attr("src",n.src)),e&&e.call()})},_getFinalImgConfig=function(a){var i,t=a.sources,m=a.imgMaxW||0,e=a.imgMaxH||0,n=f(t,a.wrapper.width),s=_getFinalSizePosition(a.image,a.wrapper);return s.checksource&&(n=f(t,s.width)),0===n.pos&&(0!==m&&s.width>m||0!==e&&s.height>e)&&(0!==m&&s.width>m?(i=s.width/m,s.width=m,s.height/=i):0!==e&&s.height>e&&(i=s.height/e,s.height=e,s.width/=i),s.left=a.wrapper.width/2-s.width/2,s.top=a.wrapper.height/2-s.height/2),{source:n,finalSizePosition:s}},_singleview=function(){var a=$(this).index();s(a)},_singleviewitem=function(t,m){Gamma.isSV=!0;var a=t.index(),e=t.data(),i=t.children("img");m&&(Gamma.fly=$("<img/>").attr("src",i.attr("src")).addClass("gamma-img-fly").css({width:i.width(),height:i.height(),left:t.offset().left+(t.outerWidth(!0)-t.width())/2,top:t.offset().top+(t.outerHeight(!0)-t.height())/2}).appendTo(l),Gamma.supportTransitions&&_setTransition(Gamma.fly));var n=_getFinalImgConfig({sources:t.data("source"),imgMaxW:t.data("maxwidth"),imgMaxH:t.data("maxheight"),wrapper:{width:r.width()-Gamma.svMargins.horizontal,height:r.height()-Gamma.svMargins.vertical},image:{width:i.width(),height:i.height()}}),s=n.source,o=n.finalSizePosition;Gamma.current=a,Gamma.overlay.show(),Gamma.settings.overlayAnimated&&m&&Gamma.supportTransitions&&_setTransition(Gamma.overlay,"opacity"),setTimeout(function(){var a,i;_applyAnimation(Gamma.overlay,{opacity:1},Gamma.settings.speed,Gamma.supportTransitions||!m,function(){if(!Gamma.isSV)return!1;Gamma.supportTransitions&&$(this).off(g),l.css("overflow-y","hidden");var a=Gamma.overlay[0];a.style.display="none",a.offsetHeight,a.style.display="block"}),t.css("visibility","hidden"),m?(a={width:o.width,height:o.height,left:o.left+r.scrollLeft()+Gamma.svMargins.horizontal/2,top:o.top+r.scrollTop()+Gamma.svMargins.vertical/2},i=Gamma.supportTransitions,_applyAnimation(Gamma.fly,a,Gamma.settings.speed,i,function(){i&&$(this).off(g),_loadSVItemFromGrid(e,o,s.src)})):_loadSVItemFromGrid(e,o,s.src)},25)},_loadSVItemFromGrid=function(a,i,t){Gamma.singleview.show(),Gamma.svDescription||(Gamma.svDescription=$("<div/>").addClass("gamma-description").appendTo(Gamma.singleview).wrap('<div class="gamma-description-wrapper"></div>'),Gamma.supportTransitions&&_setTransition(Gamma.svDescription,"opacity",Gamma.settings.svImageTransitionSpeedFade/2,Gamma.settings.svImageTransitionEasingFade)),Gamma.svDescription.html(a.description);var m=setTimeout(function(){Gamma.singleview.addClass("gamma-loading")},Gamma.settings.svImageTransitionSpeedFade+250);Gamma.svImage=$("<img/>").load(function(){var a=$(this);clearTimeout(m),Gamma.singleview.removeClass("gamma-loading"),setTimeout(function(){_applyAnimation(Gamma.svDescription,{opacity:1},Gamma.settings.svImageTransitionSpeedFade/2,Gamma.supportTransitions)},25),a.css({width:i.width,height:i.height,left:i.left+Gamma.svMargins.horizontal/2,top:i.top+Gamma.svMargins.vertical/2}).appendTo(Gamma.singleview),Gamma.supportTransitions&&_setTransition(a,"all",Gamma.settings.svImageTransitionSpeedResize,Gamma.settings.svImageTransitionEasingResize),Gamma.fly?(Gamma.supportTransitions&&_setTransition(Gamma.fly,"opacity",1e3),setTimeout(function(){_applyAnimation(Gamma.fly,{opacity:0},1e3,Gamma.supportTransitions,function(){var a=$(this);Gamma.supportTransitions&&a.off(g),a.remove(),Gamma.fly=null,Gamma.isAnimating=!1})},25)):Gamma.isAnimating=!1}).data(a).attr("src",t)},_getFinalSizePosition=function(a,i){var t,m,e,n=a.width,s=a.height,o=i.width,r=i.height,l=!1;return s<n?r<(t=s/(m=n/(e=o)))&&(l=!0,e/=m=t/r,t=r):(l=!0,o<(e=n/(m=s/(t=r)))&&(l=!1,m=e/o,e=o,t/=m)),{width:e,height:t,left:o/2-e/2,top:r/2-t/2,checksource:l}},_closesingleview=function(){if(Gamma.isAnimating||Gamma.fly)return!1;Gamma.isSV=!1,Gamma.slideshow&&_stopSlideshow();var i=Gamma.items.eq(Gamma.current),t=i.children("img");Gamma.items.not(i).css("visibility","visible");var a,m=r.scrollTop();i.is(":inViewport")||(m=i.offset().top+(i.outerHeight(!0)-i.height())/2,(a=o.height()-r.height())<m&&(m=a),r.scrollTop(m));var e=Gamma.svImage.position().left+r.scrollLeft(),n=Gamma.svImage.position().top+m;Gamma.svImage.appendTo(l).css({position:"absolute",zIndex:1e4,left:e,top:n}),Gamma.supportTransitions&&_setTransition(Gamma.svImage),Gamma.singleview.hide(),Gamma.svDescription.empty().css("opacity",0),l.css("overflow-y","scroll"),setTimeout(function(){var a={width:t.width(),height:t.height(),left:i.offset().left+(i.outerWidth(!0)-i.width())/2,top:i.offset().top+(i.outerHeight(!0)-i.height())/2};_applyAnimation(Gamma.svImage,a,Gamma.settings.speed,Gamma.supportTransitions,function(){i.css("visibility","visible"),$(this).remove(),Gamma.svImage=null}),Gamma.settings.overlayAnimated?(Gamma.supportTransitions&&_setTransition(Gamma.overlay,"opacity"),_applyAnimation(Gamma.overlay,{opacity:0},Gamma.settings.speed,Gamma.supportTransitions,function(){var a=$(this);Gamma.supportTransitions&&a.off(g),a.hide()})):Gamma.overlay.hide(),s()},25)},_visChange=function(){Gamma.slideshow&&(isHidden()?(_stopSlideshow(!0),Gamma.slideshow=!0):_prepareSlideshow())},_prepareSlideshow=function(){if(Gamma.isAnimating&&!Gamma.slideshow)return!1;Gamma.isAnimating=!0,clearTimeout(Gamma.slideshowtimeout),Gamma.slideshow=!0,Gamma.svMargins={vertical:0,horizontal:0},t(Gamma.svclose,"off"),t(Gamma.svnavprev,"off",{left:-40}),t(Gamma.svnavnext,"off",{right:-40}),_svResizeImage(function(){Gamma.isAnimating=!1,Gamma.svplay.addClass("gamma-btn-sspause"),_startSlideshow()})},_preloadNext=function(){var a=Gamma.current<Gamma.itemsCount-1?Gamma.current+1:Gamma.settings.circular?0:Gamma.current,i=Gamma.items.eq(a),t=i.children("img"),m=_getFinalImgConfig({sources:i.data("source"),imgMaxW:i.data("maxwidth"),imgMaxH:i.data("maxheight"),wrapper:{width:r.width()-Gamma.svMargins.horizontal,height:r.height()-Gamma.svMargins.vertical},image:{width:t.width(),height:t.height()}}).source;$("<img/>").attr("src",m.src)},_startSlideshow=function(){_preloadNext(),Gamma.slideshowtimeout=setTimeout(function(){w("next"),_startSlideshow()},Gamma.settings.interval)},_stopSlideshow=function(a){if(Gamma.isAnimating)return!1;Gamma.isAnimating=!0,clearTimeout(Gamma.slideshowtimeout),a||(Gamma.slideshow=!1,Gamma.svplay.removeClass("gamma-btn-sspause"),Gamma.svMargins=Gamma.settings.svMarginsVH,t(Gamma.svclose,"on"),t(Gamma.svnavprev,"on",{left:20}),t(Gamma.svnavnext,"on",{right:20}),_svResizeImage(function(){Gamma.isAnimating=!1}))},_initEvents=function(a){switch(a){case"window":Gamma.settings.historyapi&&r.on("statechange.gamma",function(){p(!0)}),r.on("smartresize.gamma",e);var i,t=getHiddenProp();t&&(i=t.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(i,_visChange));break;case"singleview":Gamma.gallery.on("click.gamma","li",_singleview),Gamma.svclose.on("click.gamma",_closesingleview);break;case"singleviewnavigation":Gamma.svnavnext.on("click.gamma",function(){m("next")}),Gamma.svnavprev.on("click.gamma",function(){m("prev")}),Gamma.settings.nextOnClickImage&&Gamma.singleview.on("click.gamma","img",function(){m("next")}),Gamma.settings.keyboard&&o.on("keydown.gamma",function(a){switch(a.keyCode||a.which){case 37:m("prev");break;case 39:m("next")}}),Gamma.settings.swipe&&Gamma.singleview.on({"swipeleft.gamma":function(){m("next")},"swiperight.gamma":function(){m("prev")}}),Gamma.svplay.on("click.gamma",function(){Gamma.slideshow?_stopSlideshow():Gamma.isAnimating||_prepareSlideshow()})}},_setTransition=function(a,i,t,m){i=i||"all",t=t||Gamma.settings.speed,m=m||Gamma.settings.easing,a.css("transition",i+" "+t+"ms "+m)},_applyAnimation=function(a,i,t,m,e){$.fn.applyStyle=m?$.fn.css:$.fn.animate,e&&m&&a.on(g,e),e=e||function(){return!1},a.stop().applyStyle(i,$.extend(!0,[],{duration:t+"ms",complete:e}))},add=function(a){Gamma.gallery.append(a),Gamma.items=Gamma.gallery.children(),Gamma.itemsCount=Gamma.items.length,h(a),i()},{init:function(a,i){Gamma.settings=$.extend(!0,{},n,a),c(),h(),u(function(){Gamma.container.removeClass("gamma-loading"),Gamma.items.show(),Gamma.settings.historyapi&&p(),_initEvents("window"),i&&i.call()})},add:add}}();
//# sourceMappingURL=gamma.js.map
