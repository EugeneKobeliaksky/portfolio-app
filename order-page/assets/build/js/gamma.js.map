{"version":3,"file":"gamma.js","sources":["gamma.js"],"sourcesContent":["/**\r\n * gamma.js v1.0.0\r\n * http://www.codrops.com\r\n *\r\n * Licensed under the MIT license.\r\n * http://www.opensource.org/licenses/mit-license.php\r\n * \r\n * Copyright 2012, Codrops\r\n * http://www.codrops.com\r\n */\r\n \r\n/**\r\n * Return a new JSON object of the old string.\r\n * Turns:\r\n * \t\tfile.js?a=1&amp;b.c=3.0&b.d=four&a_false_value=false&a_null_value=null\r\n * Into:\r\n * \t\t{\"a\":1,\"b\":{\"c\":3,\"d\":\"four\"},\"a_false_value\":false,\"a_null_value\":null}\r\n * @version 1.1.0\r\n * @date July 16, 2010\r\n * @since 1.0.0, June 30, 2010\r\n * @package jquery-sparkle {@link http://www.balupton/projects/jquery-sparkle}\r\n * @author Benjamin \"balupton\" Lupton {@link http://www.balupton.com}\r\n * @copyright (c) 2009-2010 Benjamin Arthur Lupton {@link http://www.balupton.com}\r\n * @license GNU Affero General Public License version 3 {@link http://www.gnu.org/licenses/agpl-3.0.html}\r\n */\r\nString.prototype.queryStringToJSON = String.prototype.queryStringToJSON || function ( )\r\n{\t// Turns a params string or url into an array of params\r\n\t// Prepare\r\n\tvar params = String(this);\r\n\t// Remove url if need be\r\n\tparams = params.substring(params.indexOf('?')+1);\r\n\t// params = params.substring(params.indexOf('#')+1);\r\n\t// Change + to %20, the %20 is fixed up later with the decode\r\n\tparams = params.replace(/\\+/g, '%20');\r\n\t// Do we have JSON string\r\n\tif ( params.substring(0,1) === '{' && params.substring(params.length-1) === '}' )\r\n\t{\t// We have a JSON string\r\n\t\treturn eval(decodeURIComponent(params));\r\n\t}\r\n\t// We have a params string\r\n\tparams = params.split(/\\&(amp\\;)?/);\r\n\tvar json = {};\r\n\t// We have params\r\n\tfor ( var i = 0, n = params.length; i < n; ++i )\r\n\t{\r\n\t\t// Adjust\r\n\t\tvar param = params[i] || null;\r\n\t\tif ( param === null ) { continue; }\r\n\t\tparam = param.split('=');\r\n\t\tif ( param === null ) { continue; }\r\n\t\t// ^ We now have \"var=blah\" into [\"var\",\"blah\"]\r\n\r\n\t\t// Get\r\n\t\tvar key = param[0] || null;\r\n\t\tif ( key === null ) { continue; }\r\n\t\tif ( typeof param[1] === 'undefined' ) { continue; }\r\n\t\tvar value = param[1];\r\n\t\t// ^ We now have the parts\r\n\r\n\t\t// Fix\r\n\t\tkey = decodeURIComponent(key);\r\n\t\tvalue = decodeURIComponent(value);\r\n\t\ttry {\r\n\t\t    // value can be converted\r\n\t\t    value = eval(value);\r\n\t\t} catch ( e ) {\r\n\t\t    // value is a normal string\r\n\t\t}\r\n\r\n\t\t// Set\r\n\t\t// window.console.log({'key':key,'value':value}, split);\r\n\t\tvar keys = key.split('.');\r\n\t\tif ( keys.length === 1 )\r\n\t\t{\t// Simple\r\n\t\t\tjson[key] = value;\r\n\t\t}\r\n\t\telse\r\n\t\t{\t// Advanced (Recreating an object)\r\n\t\t\tvar path = '',\r\n\t\t\t\tcmd = '';\r\n\t\t\t// Ensure Path Exists\r\n\t\t\t$.each(keys,function(ii,key){\r\n\t\t\t\tpath += '[\"'+key.replace(/\"/g,'\\\\\"')+'\"]';\r\n\t\t\t\tjsonCLOSUREGLOBAL = json; // we have made this a global as closure compiler struggles with evals\r\n\t\t\t\tcmd = 'if ( typeof jsonCLOSUREGLOBAL'+path+' === \"undefined\" ) jsonCLOSUREGLOBAL'+path+' = {}';\r\n\t\t\t\teval(cmd);\r\n\t\t\t\tjson = jsonCLOSUREGLOBAL;\r\n\t\t\t\tdelete jsonCLOSUREGLOBAL;\r\n\t\t\t});\r\n\t\t\t// Apply Value\r\n\t\t\tjsonCLOSUREGLOBAL = json; // we have made this a global as closure compiler struggles with evals\r\n\t\t\tvalueCLOSUREGLOBAL = value; // we have made this a global as closure compiler struggles with evals\r\n\t\t\tcmd = 'jsonCLOSUREGLOBAL'+path+' = valueCLOSUREGLOBAL';\r\n\t\t\teval(cmd);\r\n\t\t\tjson = jsonCLOSUREGLOBAL;\r\n\t\t\tdelete jsonCLOSUREGLOBAL;\r\n\t\t\tdelete valueCLOSUREGLOBAL;\r\n\t\t}\r\n\t\t// ^ We now have the parts added to your JSON object\r\n\t}\r\n\treturn json;\r\n};\r\n\r\n// checks if an element is partially inside the viewport\r\n// inspired by James Padolsey's snippet (http://remysharp.com/2009/01/26/element-in-view-event-plugin/#comment-127058)\r\n$.extend( $.expr[':'], {\r\n\r\n\tinViewport : function( el ) {\r\n\r\n\t\tvar scrollTop = ( document.documentElement.scrollTop || document.body.scrollTop ),\r\n\t\t\telOffsetTop = $( el ).offset().top,\r\n\t\t\telH = $( el ).height()\r\n\t\t\twinH = ( window.innerHeight && window.innerHeight < $( window ).height() ) ? window.innerHeight : $( window ).height();\r\n\r\n\t\treturn ( elOffsetTop + elH ) > scrollTop && elOffsetTop < ( scrollTop + winH );\r\n\r\n\t}\r\n\r\n});\r\n\r\n// HTML5 PageVisibility API\r\n// http://www.html5rocks.com/en/tutorials/pagevisibility/intro/\r\n// by Joe Marini (@joemarini)\r\nfunction getHiddenProp(){\r\n    var prefixes = ['webkit','moz','ms','o'];\r\n    \r\n    // if 'hidden' is natively supported just return it\r\n    if ('hidden' in document) return 'hidden';\r\n    \r\n    // otherwise loop over all the known prefixes until we find one\r\n    for (var i = 0; i < prefixes.length; i++){\r\n        if ((prefixes[i] + 'Hidden') in document) \r\n            return prefixes[i] + 'Hidden';\r\n    }\r\n\r\n    // otherwise it's not supported\r\n    return null;\r\n}\r\nfunction isHidden() {\r\n    var prop = getHiddenProp();\r\n    if (!prop) return false;\r\n    \r\n    return document[prop];\r\n}\r\n\r\nvar Gamma = (function() {\r\n\r\n\tvar $window = $( window ),\r\n\t\t$body = $( 'body' ),\r\n\t\t$document = $( document ),\r\n\t\tModernizr = window.Modernizr,\r\n\t\t// https://github.com/twitter/bootstrap/issues/2870\r\n\t\ttransEndEventNames = {\r\n\t\t\t'WebkitTransition' : 'webkitTransitionEnd',\r\n\t\t\t'MozTransition' : 'transitionend',\r\n\t\t\t'OTransition' : 'oTransitionEnd',\r\n\t\t\t'msTransition' : 'MSTransitionEnd',\r\n\t\t\t'transition' : 'transitionend'\r\n\t\t},\r\n\t\ttransEndEventName = transEndEventNames[ Modernizr.prefixed( 'transition' ) ],\r\n\t\t// default settings\r\n\t\tdefaults = {\r\n\t\t\t// default value for masonry column count\r\n\t\t\tcolumns : 4,\r\n\t\t\t// transition properties for the images in ms (transition to/from singleview)\r\n\t\t\tspeed : 300,\r\n\t\t\teasing : 'ease',\r\n\t\t\t// if set to true the overlay's opacity will animate (transition to/from singleview)\r\n\t\t\toverlayAnimated : true,\r\n\t\t\t// if true, the navigate next function is called when the image (singleview) is clicked\r\n\t\t\tnextOnClickImage : true,\r\n\t\t\t// circular navigation\r\n\t\t\tcircular : true,\r\n\t\t\t// transition settings for the image in the single view.\r\n\t\t\t// These includes:\r\n\t\t\t// - ajusting its position and size when the window is resized\r\n\t\t\t// - fading out the image when navigating\r\n\t\t\tsvImageTransitionSpeedFade : 300,\r\n\t\t\tsvImageTransitionEasingFade : 'ease-in-out',\r\n\t\t\tsvImageTransitionSpeedResize : 300,\r\n\t\t\tsvImageTransitionEasingResize : 'ease-in-out',\r\n\t\t\tsvMarginsVH : {\r\n\t\t\t\tvertical : 140,\r\n\t\t\t\thorizontal : 120\r\n\t\t\t},\r\n\t\t\t// allow keybord and swipe navigation\r\n\t\t\tkeyboard : true,\r\n\t\t\tswipe : true,\r\n\t\t\t// slideshow interval (ms)\r\n\t\t\tinterval : 4000,\r\n\t\t\t// if History API is not supported this value will turn false\r\n\t\t\thistoryapi : true\r\n\t\t},\r\n\t\tinit = function( settings, callback ) {\r\n\r\n\t\t\tGamma.settings = $.extend( true, {}, defaults, settings );\r\n\r\n\t\t\t// cache some elements..\r\n\t\t\t_config();\r\n\t\t\t// build the layout\r\n\t\t\t_layout();\r\n\t\t\t// init masonry\r\n\t\t\t_initMasonry( function() {\r\n\r\n\t\t\t\t// remove loading status\r\n\t\t\t\tGamma.container.removeClass( 'gamma-loading' );\r\n\t\t\t\t// show items\r\n\t\t\t\tGamma.items.show();\r\n\r\n\t\t\t\t// opens the single view if an image id is passed in the url\r\n\t\t\t\t// we will assume for this demo that the id is the index of the item \r\n\t\t\t\t// where the image is\r\n\t\t\t\t// example: http://www.sitename.com/gamma/?img=12\r\n\t\t\t\tif( Gamma.settings.historyapi ) {\r\n\r\n\t\t\t\t\t_goto();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// init window events\r\n\t\t\t\t_initEvents( 'window' );\r\n\r\n\t\t\t\tif( callback ) {\r\n\r\n\t\t\t\t\tcallback.call();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\t\t_config = function() {\r\n\r\n\t\t\tGamma.container = $( '#gamma-container' );\r\n\t\t\tGamma.overlay = Gamma.container.find( 'div.gamma-overlay' );\r\n\t\t\tGamma.controls = Gamma.container.children( 'div.gamma-options' );\r\n\t\t\tGamma.gallery = Gamma.container.children( 'ul.gamma-gallery' );\r\n\t\t\tGamma.items = Gamma.gallery.children();\r\n\t\t\tGamma.itemsCount = Gamma.items.length;\r\n\t\t\tGamma.columns = Gamma.settings.columns;\r\n\t\t\t// true if any animation (including preloading an image) running\r\n\t\t\tGamma.isAnimating = true;\r\n\t\t\tGamma.svMargins = Gamma.settings.svMarginsVH;\r\n\t\t\tvar History = window.History; // Note: We are using a capital H instead of a lower h\r\n\t\t\tif ( !History.enabled && Gamma.settings.historyapi ) {\r\n\r\n\t\t\t\tGamma.settings.historyapi = false;\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\tGamma.supportTransitions = Modernizr.csstransitions;\r\n\r\n\t\t},\r\n\t\t_createSingleView = function() {\r\n\r\n\t\t\t// the single view will include the image, navigation buttons and close, play, and pause buttons\r\n\r\n\t\t\tif( !Gamma.singleview ) {\r\n\r\n\t\t\t\t$( '<div class=\"gamma-single-view\"><div class=\"gamma-options gamma-options-single\"><div class=\"gamma-buttons\"><button class=\"gamma-btn-close\"></button></div></div></div>' )\r\n\t\t\t\t.appendTo( Gamma.container );\r\n\r\n\t\t\t\tGamma.singleview = Gamma.container.children( 'div.gamma-single-view' );\r\n\t\t\t\tGamma.svclose = Gamma.singleview.find( 'button.gamma-btn-close' );\r\n\r\n\t\t\t\t_initEvents( 'singleview' );\r\n\r\n\t\t\t\t_createSingleViewNavigation();\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\telse if( !Gamma.nav ) {\r\n\r\n\t\t\t\t_createSingleViewNavigation();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t_createSingleViewNavigation = function() {\r\n\r\n\t\t\tif( Gamma.itemsCount > 1 ) {\r\n\r\n\t\t\t\tGamma.svplay = $( '<button class=\"gamma-btn-ssplay\"></button>' ).insertAfter( Gamma.svclose );\r\n\t\t\t\tGamma.nav = $( '<nav class=\"gamma-nav\"><span class=\"gamma-prev\"></span><span class=\"gamma-next\"></span></nav>' ).appendTo( Gamma.singleview );\r\n\t\t\t\tGamma.svnavnext = Gamma.nav.find( 'span.gamma-next' );\r\n\t\t\t\tGamma.svnavprev = Gamma.nav.find( 'span.gamma-prev' );\r\n\r\n\t\t\t\t_initEvents( 'singleviewnavigation' );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// controller: \"goes to\" a specific image or back to the grid\r\n\t\t_goto = function( anim, id ) {\r\n\r\n\t\t\tif( Gamma.settings.historyapi ) {\r\n\t\t\t\t\r\n\t\t\t\t// get the url from history state (e.g. id=3) and extract the id\r\n\t\t\t\tid = id || History.getState().url.queryStringToJSON().id;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar isSingleview = ( id != undefined ),\r\n\t\t\t\tanim = anim || false;\r\n\r\n\t\t\t// back history to a state with no id\r\n\t\t\tif( Gamma.settings.historyapi && Gamma.isSV && id === undefined ) {\r\n\r\n\t\t\t\t_closesingleview();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif( isSingleview ) {\r\n\r\n\t\t\t\tvar $item = Gamma.items.eq( Math.abs( id ) );\r\n\r\n\t\t\t\tif( $item.length ) {\r\n\r\n\t\t\t\t\tif( Gamma.svImage ) {\r\n\r\n\t\t\t\t\t\t// navigating\r\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t\t\t_setTransition( Gamma.svImage , 'all', Gamma.settings.svImageTransitionSpeedFade , Gamma.settings.svImageTransitionEasingFade );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_applyAnimation( Gamma.svImage, { opacity : 0 }, Gamma.settings.svImageTransitionSpeedFade, Gamma.supportTransitions, function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t$( this ).remove();\r\n\t\t\t\t\t\t\tanim = false;\r\n\t\t\t\t\t\t\t_singleviewitem( $item, anim );\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\tif( Gamma.svDescription ) {\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t_applyAnimation( Gamma.svDescription, { opacity : 0 }, 400, Gamma.supportTransitions );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\tif( Gamma.svDescription ) {\r\n\t\t\t\t\r\n\t\t\t\t\t\t\tGamma.svDescription.empty();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_singleviewitem( $item, anim );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// saves the history state / or if history not supported goes to specific image\r\n\t\t_saveState = function( id ) {\r\n\r\n\t\t\tif( !Gamma.settings.historyapi && id != undefined ) {\r\n\r\n\t\t\t\tGamma.isSV ? _goto( false, id ) : _goto( true, id );\r\n\r\n\t\t\t}\r\n\t\t\telse if( id === undefined ) {\r\n\r\n\t\t\t\tHistory.pushState( null, null, url('protocol') + '://' + url('hostname') + url('path') );\r\n\r\n\t\t\t}\r\n\t\t\t// adds a new state to the history object\r\n\t\t\t// this will trigger the statechange on the window\r\n\t\t\telse if( History.getState().url.queryStringToJSON().id !== id ) {\r\n\t\t\t\t\t\r\n\t\t\t\tHistory.pushState( null, null, '?id=' + id );\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\r\n\t\t},\r\n\t\t// transform initial html structure into a list of images (well mostly)\r\n\t\t_layout = function( $items ) {\r\n\r\n\t\t\tif( Gamma.itemsCount > 0 ) {\r\n\r\n\t\t\t\t_createSingleView();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_setMasonry();\r\n\r\n\t\t\tvar $items = $items || Gamma.items.hide();\r\n\r\n\t\t\t// replace each div element with an image element with the right source\r\n\t\t\t$items.each( function() {\r\n\r\n\t\t\t\tvar $item = $( this ),\r\n\t\t\t\t\t$picEl = $item.children(),\r\n\t\t\t\t\tsources = _getImgSources( $picEl ),\r\n\t\t\t\t\tsource = _chooseImgSource( sources, $item.outerWidth( true ) ),\r\n\t\t\t\t\tdescription = $picEl.data( 'description' );\r\n\r\n\t\t\t\t// data is saved in the <li> element\r\n\t\t\t\t$item.data( {\r\n\t\t\t\t\tdescription : description,\r\n\t\t\t\t\tsource : sources,\r\n\t\t\t\t\tmaxwidth : $picEl.data( 'maxWidth' ),\r\n\t\t\t\t\tmaxheight : $picEl.data( 'maxHeight' )\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t$( '<div/>' ).addClass( 'gamma-description' ).html( description ).insertAfter( $picEl );\r\n\r\n\t\t\t\t$( '<img/>' ).attr( {\r\n\t\t\t\t\talt : $picEl.data( 'alt' ),\r\n\t\t\t\t\ttitle : $picEl.data( 'title' ),\r\n\t\t\t\t\tsrc : source.src\r\n\t\t\t\t} ).insertAfter( $picEl );\r\n\r\n\t\t\t\t$picEl.remove();\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\t\t// gets all possible image sources of an element\r\n\t\t_getImgSources = function( $el ) {\r\n\r\n\t\t\tvar theSources = [];\r\n\t\t\t$el.children( 'div' ).each( function( i ) {\r\n\r\n\t\t\t\tvar $source = $( this );\r\n\t\t\t\ttheSources.push( {\r\n\t\t\t\t\twidth : $source.data( 'minWidth' ) || 0,\r\n\t\t\t\t\tsrc : $source.data( 'src' ),\r\n\t\t\t\t\tpos : i\r\n\t\t\t\t} );\r\n\r\n\t\t\t} );\r\n\t\t\t\r\n\t\t\treturn theSources;\r\n\r\n\t\t},\r\n\t\t// change the number of masonry columns based on the current container's width and the settings.viewport configuration\r\n\t\t_setMasonry = function() {\r\n\r\n\t\t\tvar containerW = Gamma.container.width();\r\n\r\n\t\t\tif( Gamma.settings.viewport ) {\r\n\r\n\t\t\t\tfor( var i = 0, len = Gamma.settings.viewport.length; i < len; ++i ) {\r\n\r\n\t\t\t\t\tvar viewport = Gamma.settings.viewport[i];\r\n\r\n\t\t\t\t\tif( containerW > viewport.width ) {\r\n\r\n\t\t\t\t\t\tGamma.columns = viewport.columns;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// set the widths (%) for each of the <li>\r\n\t\t\tGamma.items.css( 'width', Math.floor( containerW / Gamma.columns ) * 100 / containerW + '%' );\r\n\r\n\t\t},\r\n\t\t// initialize masonry\r\n\t\t_initMasonry = function( callback ) {\r\n\r\n\t\t\tGamma.gallery.imagesLoaded( function() {\r\n\r\n\t\t\t\tGamma.gallery.masonry( {\r\n\t\t\t\t\titemSelector : 'li',\r\n\t\t\t\t\tcolumnWidth : function( containerWidth ) {\r\n\t\t\t\t\t\treturn containerWidth / Gamma.columns;\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif( callback ) {\r\n\r\n\t\t\t\t\tcallback.call();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\t\t// reloads masonry grid\r\n\t\t_reloadMasonry = function( timeout ) {\r\n\r\n\t\t\tclearTimeout( Gamma.masonrytimeout );\r\n\t\t\ttimeout = timeout || 0;\r\n\t\t\tGamma.masonrytimeout = setTimeout( function() { Gamma.gallery.masonry( 'reload' ); }, timeout );\r\n\r\n\t\t},\r\n\t\t// choose a source based on the item's size and on the configuration set by the user in the initial HTML\r\n\t\t_chooseImgSource = function( sources, w ) {\r\n\r\n\t\t\tif( w <= 0 ) {\r\n\t\t\t\tw = 1;\r\n\t\t\t}\r\n\r\n\t\t\tfor( var i = 0, len = sources.length; i < len; ++i ) {\r\n\r\n\t\t\t\tvar source = sources[i];\r\n\r\n\r\n\t\t\t\tif( w > source.width ) {\r\n\r\n\t\t\t\t\treturn source;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// show or hide a specific control button\r\n\t\t_toggleControl = function( $control, status, animStyle ) {\r\n\r\n\t\t\tanimStyle ? $control.css( animStyle ) : status === 'on' ? $control.show() : $control.hide();\r\n\r\n\t\t},\r\n\t\t// triggered on the events for the nav buttons, keyboard, swipe\r\n\t\t_onnavigate = function( dir ) {\r\n\r\n\t\t\tif( !Gamma.slideshow ) {\r\n\r\n\t\t\t\t_navigate( dir );\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// goes to next or previous image\r\n\t\t_navigate = function( dir ) {\r\n\r\n\t\t\tif( !Gamma.isSV || Gamma.isAnimating ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar current = Gamma.current;\r\n\r\n\t\t\tif( dir === 'next' ) {\r\n\r\n\t\t\t\tGamma.current = Gamma.current < Gamma.itemsCount - 1 ? ++Gamma.current :\r\n\t\t\t\t\tGamma.settings.circular ? 0 : Gamma.current;\r\n\r\n\t\t\t}\r\n\t\t\telse if( dir === 'prev' ) {\r\n\r\n\t\t\t\tGamma.current = Gamma.current > 0 ? --Gamma.current :\r\n\t\t\t\t\tGamma.settings.circular ? Gamma.itemsCount - 1 : Gamma.current;\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\tif( current === Gamma.current ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tGamma.isAnimating = true;\r\n\r\n\t\t\t// get positions, dimentions and source for the new item\r\n\t\t\t_saveState( Gamma.current );\r\n\r\n\t\t},\r\n\t\t// resize the window event\r\n\t\t_resize = function() {\r\n\r\n\t\t\t_setMasonry();\r\n\r\n\t\t\t_resizeGrid();\r\n\r\n\t\t\t// change the size, position and source of the image (single view) accordingly\r\n\t\t\tif( Gamma.isSV ) {\r\n\r\n\t\t\t\t_svResizeImage();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// seems that sometimes the masonry columns stay out of order.\r\n\t\t\t// just to make sure this doesnt happen\r\n\t\t\t_reloadMasonry( 200 );\r\n\r\n\t\t},\r\n\t\t// resizes the masonry grid\r\n\t\t// change the source of the images (grid) accordingly\r\n\t\t_resizeGrid = function() {\r\n\r\n\t\t\tGamma.items.each( function() {\r\n\r\n\t\t\t\tvar $item = $( this ),\r\n\t\t\t\t\tsource = _chooseImgSource( $item.data( 'source' ), Gamma.items.outerWidth( true ) );\r\n\r\n\t\t\t\t$item.find( 'img' ).attr( 'src', source.src );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t// resize and chooses (if necessary) a new source for the image in the single view\r\n\t\t_svResizeImage = function( callback ) {\r\n\r\n\t\t\t// need to know which source to load for the image.\r\n\t\t\t// also need to know the final size and position.\r\n\t\t\tvar finalConfig = _getFinalImgConfig( {\r\n\r\n\t\t\t\t\tsources : Gamma.svImage.data( 'source' ),\r\n\t\t\t\t\timgMaxW : Gamma.svImage.data( 'maxwidth' ),\r\n\t\t\t\t\timgMaxH : Gamma.svImage.data( 'maxheight' ),\r\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\r\n\t\t\t\t\timage : { width : Gamma.svImage.width(), height : Gamma.svImage.height() }\r\n\r\n\t\t\t\t} ),\r\n\t\t\t\tsource = finalConfig.source,\r\n\t\t\t\tfinalSizePosition = finalConfig.finalSizePosition,\r\n\r\n\t\t\t\tcurrentSrc = Gamma.svImage.attr('src'),\r\n\r\n\t\t\t\tfinalStyle = {\r\n\t\t\t\t\twidth : finalSizePosition.width,\r\n\t\t\t\t\theight : finalSizePosition.height,\r\n\t\t\t\t\tleft : finalSizePosition.left + Gamma.svMargins.horizontal / 2,\r\n\t\t\t\t\ttop : finalSizePosition.top + Gamma.svMargins.vertical / 2\r\n\t\t\t\t};\r\n\r\n\t\t\t_applyAnimation( Gamma.svImage, finalStyle, Gamma.settings.svImageTransitionSpeedResize, Gamma.supportTransitions, function() {\r\n\r\n\t\t\t\tif( Gamma.supportTransitions ) {\r\n\t\t\t\t\t$( this ).off( transEndEventName );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// if source changes, change reset Gamma.svImage\r\n\t\t\t\tif( currentSrc !== source.src ) {\r\n\r\n\t\t\t\t\t// going to load a new image..\r\n\t\t\t\t\tGamma.isAnimating = true;\r\n\r\n\t\t\t\t\tvar w = Gamma.svImage.width(),\r\n\t\t\t\t\t\th = Gamma.svImage.height(),\r\n\t\t\t\t\t\tl = Gamma.svImage.position().left,\r\n\t\t\t\t\t\tt = Gamma.svImage.position().top;\r\n\r\n\t\t\t\t\tGamma.svImage = $( '<img/>' ).load( function() {\r\n\r\n\t\t\t\t\t\tvar $img = $( this );\r\n\r\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t\t\t_setTransition( $img , 'all', Gamma.settings.svImageTransitionSpeedResize , Gamma.settings.svImageTransitionEasingResize );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_applyAnimation( $img.next(), { opacity : 0 }, 500, Gamma.supportTransitions, function() {\r\n\r\n\t\t\t\t\t\t\tvar $img = $( this );\r\n\t\t\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\t\t\t\t\t\t\t\t$( this ).off( transEndEventName );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$img.remove();\r\n\t\t\t\t\t\t\tGamma.isAnimating = false;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t.css( { width : w, height : h, left : l, top : t } )\r\n\t\t\t\t\t.data( Gamma.svImage.data() )\r\n\t\t\t\t\t.insertBefore( Gamma.svImage )\r\n\t\t\t\t\t.attr( 'src', source.src );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( callback ) {\r\n\r\n\t\t\t\t\tcallback.call();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\t\t// gets the position and sizes of the image given its container properties\r\n\t\t_getFinalImgConfig = function( properties ) {\r\n\r\n\t\t\tvar sources = properties.sources,\r\n\t\t\t\timgMaxW = properties.imgMaxW || 0,\r\n\t\t\t\timgMaxH = properties.imgMaxH || 0,\r\n\t\t\t\tsource = _chooseImgSource( sources, properties.wrapper.width ), \r\n\t\t\t\t// calculate final size and position of image\r\n\t\t\t\tfinalSizePosition = _getFinalSizePosition( properties.image, properties.wrapper );\r\n\r\n\t\t\t// check for new source\r\n\t\t\tif( finalSizePosition.checksource ) {\r\n\r\n\t\t\t\tsource = _chooseImgSource( sources, finalSizePosition.width );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// we still need to check one more detail:\r\n\t\t\t// if the source is the largest one provided in the html rules,\r\n\t\t\t// then we need to check if the final width/height are eventually bigger\r\n\t\t\t// than the original image sizes. If so, we will show the image \r\n\t\t\t// with its original size, avoiding like this that the image gets pixelated\r\n\t\t\tif( source.pos === 0 && ( imgMaxW !== 0 && finalSizePosition.width > imgMaxW || imgMaxH !== 0 && finalSizePosition.height > imgMaxH ) ) {\r\n\r\n\t\t\t\tif( imgMaxW !== 0 && finalSizePosition.width > imgMaxW ) {\r\n\r\n\t\t\t\t\tvar ratio = finalSizePosition.width / imgMaxW;\r\n\t\t\t\t\tfinalSizePosition.width = imgMaxW;\r\n\t\t\t\t\tfinalSizePosition.height /= ratio;\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse if( imgMaxH !== 0 && finalSizePosition.height > imgMaxH ) {\r\n\r\n\t\t\t\t\tvar ratio = finalSizePosition.height / imgMaxH;\r\n\t\t\t\t\tfinalSizePosition.height = imgMaxH;\r\n\t\t\t\t\tfinalSizePosition.width /= ratio;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfinalSizePosition.left = properties.wrapper.width / 2 - finalSizePosition.width / 2;\r\n\t\t\t\tfinalSizePosition.top = properties.wrapper.height / 2 - finalSizePosition.height / 2;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tsource : source,\r\n\t\t\t\tfinalSizePosition : finalSizePosition\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\t// triggered when one grid image is clicked\r\n\t\t_singleview = function() {\r\n\r\n\t\t\tvar id = $( this ).index();\r\n\t\t\t_saveState( id );\r\n\r\n\t\t},\r\n\t\t// shows the item\r\n\t\t_singleviewitem = function( $item, anim ) {\r\n\r\n\t\t\tGamma.isSV = true;\r\n\r\n\t\t\tvar id = $item.index(),\r\n\t\t\t\tdata = $item.data(),\r\n\t\t\t\t$img = $item.children( 'img' );\r\n\t\t\t\t\r\n\t\t\tif( anim ) {\r\n\r\n\t\t\t\tGamma.fly = $( '<img/>' ).attr( 'src', $img.attr( 'src' ) ).addClass( 'gamma-img-fly' ).css( {\r\n\t\t\t\t\twidth : $img.width(),\r\n\t\t\t\t\theight : $img.height(),\r\n\t\t\t\t\tleft : $item.offset().left + ( $item.outerWidth( true ) - $item.width() ) / 2,\r\n\t\t\t\t\ttop : $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2\r\n\t\t\t\t} ).appendTo( $body );\r\n\r\n\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t_setTransition( Gamma.fly );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t// need to know which source to load for the image.\r\n\t\t\t// also need to know the final size and position.\r\n\t\t\tvar\tfinalConfig = _getFinalImgConfig( {\r\n\r\n\t\t\t\t\tsources : $item.data( 'source' ),\r\n\t\t\t\t\timgMaxW : $item.data( 'maxwidth' ),\r\n\t\t\t\t\timgMaxH : $item.data( 'maxheight' ),\r\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\r\n\t\t\t\t\timage : { width : $img.width(), height : $img.height() }\r\n\r\n\t\t\t\t} ),\t\r\n\t\t\t\tsource = finalConfig.source,\r\n\t\t\t\tfinalSizePosition = finalConfig.finalSizePosition;\r\n\r\n\t\t\tGamma.current = id;\r\n\r\n\t\t\t// transition: overlay opacity\r\n\t\t\tGamma.overlay.show();\r\n\r\n\t\t\tif( Gamma.settings.overlayAnimated && anim && Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t_setTransition( Gamma.overlay , 'opacity' );\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsetTimeout( function() {\r\n\r\n\t\t\t\t_applyAnimation( Gamma.overlay, { 'opacity' : 1 }, Gamma.settings.speed, Gamma.supportTransitions || !anim, function() {\r\n\r\n\t\t\t\t\tif( !Gamma.isSV ) {\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\t\t\t\t\t\t$( this ).off( transEndEventName );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// set the overflow-y to hidden\r\n\t\t\t\t\t$body.css( 'overflow-y', 'hidden' );\r\n\t\t\t\t\t// force repaint. Chrome in Windows does not remove overflow..\r\n\t\t\t\t\t// http://stackoverflow.com/a/3485654/989439\r\n\t\t\t\t\tvar el = Gamma.overlay[0];\r\n\t\t\t\t\tel.style.display='none';\r\n\t\t\t\t\tel.offsetHeight; // no need to store this anywhere, the reference is enough\r\n\t\t\t\t\tel.style.display='block';\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t$item.css( 'visibility', 'hidden' );\r\n\r\n\t\t\t\tif( !anim ) {\r\n\r\n\t\t\t\t\t_loadSVItemFromGrid( data, finalSizePosition, source.src );\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tvar styleCSS = {\r\n\t\t\t\t\t\t\twidth : finalSizePosition.width,\r\n\t\t\t\t\t\t\theight : finalSizePosition.height,\r\n\t\t\t\t\t\t\tleft : finalSizePosition.left + $window.scrollLeft() + Gamma.svMargins.horizontal / 2,\r\n\t\t\t\t\t\t\ttop : finalSizePosition.top + $window.scrollTop() + Gamma.svMargins.vertical / 2\r\n\t\t\t\t\t\t}, \r\n\t\t\t\t\t\tcond = Gamma.supportTransitions;\r\n\r\n\t\t\t\t\t_applyAnimation( Gamma.fly, styleCSS, Gamma.settings.speed, cond, function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif( cond ) {\r\n\t\t\t\t\t\t\t$( this ).off( transEndEventName );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_loadSVItemFromGrid( data, finalSizePosition, source.src );\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 25 );\r\n\r\n\t\t},\r\n\t\t// load new image for the new item to show\r\n\t\t_loadSVItemFromGrid = function( data, position, src ) {\r\n\r\n\t\t\t// show single view\r\n\t\t\tGamma.singleview.show();\r\n\r\n\t\t\t// add description\r\n\t\t\tif( !Gamma.svDescription ) {\r\n\t\t\t\t\r\n\t\t\t\tGamma.svDescription = $( '<div/>' )\r\n\t\t\t\t\t\t\t\t\t\t.addClass( 'gamma-description' )\r\n\t\t\t\t\t\t\t\t\t\t.appendTo( Gamma.singleview ).wrap( '<div class=\"gamma-description-wrapper\"></div>' );\r\n\r\n\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t_setTransition( Gamma.svDescription , 'opacity', Gamma.settings.svImageTransitionSpeedFade / 2 , Gamma.settings.svImageTransitionEasingFade );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tGamma.svDescription.html( data.description );\r\n\r\n\t\t\t// loading status: give a little amount of time before displaying it\r\n\t\t\tvar loadingtimeout = setTimeout( function() { Gamma.singleview.addClass( 'gamma-loading' );\t}, Gamma.settings.svImageTransitionSpeedFade + 250 );\r\n\t\t\t\r\n\t\t\t// preload the new image\r\n\t\t\tGamma.svImage = $( '<img/>' ).load( function() {\r\n\r\n\t\t\t\tvar $img = $( this );\r\n\r\n\t\t\t\t// remove loading status\r\n\t\t\t\tclearTimeout( loadingtimeout );\r\n\t\t\t\tGamma.singleview.removeClass( 'gamma-loading' );\r\n\r\n\t\t\t\tsetTimeout( function() {\r\n\r\n\t\t\t\t\t_applyAnimation( Gamma.svDescription, { 'opacity' : 1 }, Gamma.settings.svImageTransitionSpeedFade / 2, Gamma.supportTransitions );\r\n\r\n\t\t\t\t}, 25 );\r\n\r\n\t\t\t\t$img.css( {\r\n\t\t\t\t\twidth : position.width,\r\n\t\t\t\t\theight : position.height,\r\n\t\t\t\t\tleft : position.left + Gamma.svMargins.horizontal / 2,\r\n\t\t\t\t\ttop : position.top + Gamma.svMargins.vertical / 2\r\n\t\t\t\t} ).appendTo( Gamma.singleview );\r\n\r\n\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t_setTransition( $img , 'all', Gamma.settings.svImageTransitionSpeedResize , Gamma.settings.svImageTransitionEasingResize );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( Gamma.fly ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t\t_setTransition( Gamma.fly, 'opacity', 1000 );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout( function() {\r\n\r\n\t\t\t\t\t\t_applyAnimation( Gamma.fly, { 'opacity' : 0 }, 1000, Gamma.supportTransitions, function() {\r\n\r\n\t\t\t\t\t\t\tvar $this = $( this );\r\n\r\n\t\t\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\t\t\t\t\t\t\t\t$this.off( transEndEventName );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t$this.remove();\r\n\t\t\t\t\t\t\tGamma.fly = null;\r\n\t\t\t\t\t\t\tGamma.isAnimating = false;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}, 25 );\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tGamma.isAnimating = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} ).data( data ).attr( 'src', src );\r\n\r\n\t\t},\r\n\t\t// given the wrapper's width and height, calculates the final width, height, left and top for the image to fit inside\r\n\t\t_getFinalSizePosition = function( imageSize, wrapperSize ) {\r\n\r\n\t\t\t// image size\r\n\t\t\tvar imgW = imageSize.width,\r\n\t\t\t\timgH = imageSize.height,\r\n\r\n\t\t\t\t// container size\r\n\t\t\t\twrapperW = wrapperSize.width,\r\n\t\t\t\twrapperH = wrapperSize.height,\r\n\r\n\t\t\t\tfinalW, finalH, finalL, finalT,\r\n\t\t\t\t// flag to indicate we could check for another source (smaller) for the image\r\n\t\t\t\tchecksource = false;\r\n\r\n\t\t\t// check which image side is bigger\r\n\t\t\tif( imgW > imgH ) {\r\n\r\n\t\t\t\tfinalW = wrapperW;\r\n\t\t\t\t// calculate the height given the finalW\r\n\t\t\t\tvar ratio = imgW / wrapperW;\r\n\r\n\t\t\t\tfinalH = imgH / ratio;\r\n\t\t\t\t\r\n\t\t\t\tif( finalH > wrapperH ) {\r\n\r\n\t\t\t\t\tchecksource = true;\r\n\t\t\t\t\tratio = finalH / wrapperH;\r\n\t\t\t\t\tfinalW /= ratio;\r\n\t\t\t\t\tfinalH = wrapperH;\r\n\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\r\n\t\t\t\tfinalH = wrapperH;\r\n\t\t\t\t// calculate the width given the finalH\r\n\t\t\t\tvar ratio = imgH / wrapperH;\r\n\r\n\t\t\t\tfinalW = imgW / ratio;\r\n\r\n\t\t\t\tchecksource = true;\r\n\t\t\t\t\r\n\t\t\t\tif( finalW > wrapperW ) {\r\n\r\n\t\t\t\t\tchecksource = false;\r\n\r\n\t\t\t\t\tratio = finalW / wrapperW;\r\n\t\t\t\t\tfinalW = wrapperW;\r\n\t\t\t\t\tfinalH /= ratio;\r\n\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\twidth : finalW,\r\n\t\t\t\theight : finalH,\r\n\t\t\t\tleft : wrapperW / 2 - finalW / 2,\r\n\t\t\t\ttop : wrapperH / 2 - finalH / 2,\r\n\t\t\t\tchecksource : checksource\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\t// closes the single view\r\n\t\t_closesingleview = function() {\r\n\r\n\t\t\tif( Gamma.isAnimating || Gamma.fly ) {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tGamma.isSV = false;\r\n\r\n\t\t\tif( Gamma.slideshow ) {\r\n\r\n\t\t\t\t_stopSlideshow();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar $item = Gamma.items.eq( Gamma.current ),\r\n\t\t\t\t$img = $item.children( 'img' );\r\n\r\n\t\t\tGamma.items.not( $item ).css( 'visibility', 'visible' );\r\n\r\n\t\t\t// scroll window to item's position if item is not \"partially\" visible\r\n\t\t\tvar wst = $window.scrollTop();\r\n\r\n\t\t\tif( !$item.is( ':inViewport' ) ) {\r\n\r\n\t\t\t\twst = $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2;\r\n\r\n\t\t\t\tvar diff = $document.height() - $window.height();\r\n\r\n\t\t\t\tif( wst > diff ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\twst = diff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$window.scrollTop( wst );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar l = Gamma.svImage.position().left + $window.scrollLeft(),\r\n\t\t\t\tt = Gamma.svImage.position().top + wst;\r\n\r\n\t\t\tGamma.svImage.appendTo( $body ).css( {\r\n\t\t\t\tposition : 'absolute',\r\n\t\t\t\tzIndex : 10000,\r\n\t\t\t\tleft : l,\r\n\t\t\t\ttop : t \r\n\t\t\t} );\r\n\t\t\t\r\n\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t_setTransition( Gamma.svImage  );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tGamma.singleview.hide();\r\n\t\t\tGamma.svDescription.empty().css( 'opacity', 0 );\r\n\t\t\t$body.css( 'overflow-y', 'scroll' );\r\n\r\n\t\t\tsetTimeout( function() {\r\n\r\n\t\t\t\tvar styleCSS = {\r\n\t\t\t\t\twidth : $img.width(),\r\n\t\t\t\t\theight : $img.height(),\r\n\t\t\t\t\tleft : $item.offset().left + ( $item.outerWidth( true ) - $item.width() ) / 2,\r\n\t\t\t\t\ttop : $item.offset().top + ( $item.outerHeight( true ) - $item.height() ) / 2\r\n\t\t\t\t}\r\n\t\t\t\t_applyAnimation( Gamma.svImage, styleCSS, Gamma.settings.speed, Gamma.supportTransitions, function() {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t$item.css( 'visibility', 'visible' );\r\n\t\t\t\t\t$( this ).remove();\r\n\t\t\t\t\tGamma.svImage = null;\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t// transition: overlay opacity\r\n\t\t\t\tif( Gamma.settings.overlayAnimated ) {\r\n\r\n\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\r\n\t\t\t\t\t\t_setTransition( Gamma.overlay , 'opacity' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_applyAnimation( Gamma.overlay, { 'opacity' : 0 }, Gamma.settings.speed, Gamma.supportTransitions, function() {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar $this = $( this );\r\n\r\n\t\t\t\t\t\tif( Gamma.supportTransitions ) {\r\n\t\t\t\t\t\t\t$this.off( transEndEventName );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$this.hide();\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tGamma.overlay.hide();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_saveState();\r\n\r\n\t\t\t}, 25 );\r\n\r\n\t\t},\r\n\t\t// the slideshow is active only if the page is visible\r\n\t\t_visChange = function() {\r\n\r\n\t\t\tif( Gamma.slideshow ) {\r\n\r\n\t\t\t\tisHidden() ? ( _stopSlideshow( true ), Gamma.slideshow = true ) : _prepareSlideshow();\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// before slideshow starts\r\n\t\t_prepareSlideshow = function() {\r\n\r\n\t\t\tif( Gamma.isAnimating && !Gamma.slideshow ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tGamma.isAnimating = true;\r\n\r\n\t\t\tclearTimeout( Gamma.slideshowtimeout );\r\n\r\n\t\t\tGamma.slideshow = true;\r\n\t\t\t// container is the window\r\n\t\t\tGamma.svMargins = {\r\n\t\t\t\tvertical : 0,\r\n\t\t\t\thorizontal : 0\r\n\t\t\t};\r\n\t\t\t_toggleControl( Gamma.svclose, 'off' );\r\n\t\t\t_toggleControl( Gamma.svnavprev, 'off', { left : -40 } );\r\n\t\t\t_toggleControl( Gamma.svnavnext, 'off', { right : -40 } );\r\n\t\t\t\r\n\t\t\t_svResizeImage( function() {\r\n\r\n\t\t\t\tGamma.isAnimating = false;\r\n\r\n\t\t\t\tGamma.svplay.addClass( 'gamma-btn-sspause' );\r\n\t\t\t\t_startSlideshow();\r\n\r\n\t\t\t} );\r\n\r\n\t\t},\r\n\t\t_preloadNext = function() {\r\n\r\n\t\t\t// preload image for Gamma.current + 1\r\n\t\t\tvar next = Gamma.current < Gamma.itemsCount - 1 ? Gamma.current + 1 :\r\n\t\t\t\tGamma.settings.circular ? 0 : Gamma.current,\r\n\t\t\t\t$item = Gamma.items.eq( next ),\r\n\t\t\t\t$img = $item.children( 'img' ),\r\n\t\t\t\tfinalConfig = _getFinalImgConfig( {\r\n\r\n\t\t\t\t\tsources : $item.data( 'source' ),\r\n\t\t\t\t\timgMaxW : $item.data( 'maxwidth' ),\r\n\t\t\t\t\timgMaxH : $item.data( 'maxheight' ),\r\n\t\t\t\t\twrapper : { width : $window.width() - Gamma.svMargins.horizontal, height : $window.height() - Gamma.svMargins.vertical },\r\n\t\t\t\t\timage : { width : $img.width(), height : $img.height() }\r\n\r\n\t\t\t\t} ),\t\r\n\t\t\t\tsource = finalConfig.source;\r\n\r\n\t\t\t$( '<img/>' ).attr( 'src', source.src );\r\n\r\n\t\t},\r\n\t\t// starts slideshow\r\n\t\t_startSlideshow = function() {\r\n\r\n\t\t\t_preloadNext();\r\n\r\n\t\t\tGamma.slideshowtimeout = setTimeout( function() {\r\n\r\n\t\t\t\t_navigate( 'next' );\r\n\t\t\t\t_startSlideshow();\r\n\r\n\t\t\t}, Gamma.settings.interval );\r\n\r\n\t\t},\r\n\t\t// stops slideshow\r\n\t\t_stopSlideshow = function( pause ) {\r\n\r\n\t\t\tif( Gamma.isAnimating ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tGamma.isAnimating = true;\r\n\r\n\t\t\tclearTimeout( Gamma.slideshowtimeout );\r\n\t\t\tif( !pause ) {\r\n\r\n\t\t\t\tGamma.slideshow = false;\r\n\t\t\t\tGamma.svplay.removeClass( 'gamma-btn-sspause' );\r\n\t\t\t\tGamma.svMargins = Gamma.settings.svMarginsVH;\r\n\t\t\t\t_toggleControl( Gamma.svclose, 'on' );\r\n\t\t\t\t_toggleControl( Gamma.svnavprev, 'on', { left : 20 } );\r\n\t\t\t\t_toggleControl( Gamma.svnavnext, 'on', { right : 20 } );\r\n\t\t\t\t_svResizeImage( function() {\r\n\r\n\t\t\t\t\tGamma.isAnimating = false;\r\n\r\n\t\t\t\t} );\r\n\t\t\t\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t// initializes events according to type\r\n\t\t_initEvents = function( type ) {\r\n\r\n\t\t\tswitch( type ) {\r\n\r\n\t\t\t\tcase 'window' : \r\n\r\n\t\t\t\t\tif( Gamma.settings.historyapi ) {\r\n\r\n\t\t\t\t\t\t$window.on( 'statechange.gamma', function() {\r\n\r\n\t\t\t\t\t\t\t_goto( true );\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$window.on( 'smartresize.gamma', _resize );\r\n\r\n\t\t\t\t\t// use the property name to generate the prefixed event name\r\n\t\t\t\t\tvar visProp = getHiddenProp();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// HTML5 PageVisibility API\r\n\t\t\t\t\t// http://www.html5rocks.com/en/tutorials/pagevisibility/intro/\r\n\t\t\t\t\t// by Joe Marini (@joemarini)\r\n\t\t\t\t\tif (visProp) {\r\n\r\n\t\t\t\t\t\tvar evtname = visProp.replace(/[H|h]idden/,'') + 'visibilitychange';\r\n\t\t\t\t\t\tdocument.addEventListener(evtname, _visChange);\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'singleview' : \r\n\r\n\t\t\t\t\tGamma.gallery.on( 'click.gamma', 'li', _singleview );\r\n\t\t\t\t\tGamma.svclose.on( 'click.gamma', _closesingleview );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'singleviewnavigation' : \r\n\r\n\t\t\t\t\tGamma.svnavnext.on( 'click.gamma', function() { _onnavigate( 'next' ); } );\r\n\t\t\t\t\tGamma.svnavprev.on( 'click.gamma', function() { _onnavigate( 'prev' ); } );\r\n\r\n\t\t\t\t\tif( Gamma.settings.nextOnClickImage ) {\r\n\r\n\t\t\t\t\t\tGamma.singleview.on( 'click.gamma', 'img', function() { _onnavigate( 'next' ); } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( Gamma.settings.keyboard ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t$document.on( 'keydown.gamma', function( event ) {\r\n\r\n\t\t\t\t\t\t\tvar keyCode = event.keyCode || event.which,\r\n\t\t\t\t\t\t\t\tarrow = {\r\n\t\t\t\t\t\t\t\t\tleft: 37,\r\n\t\t\t\t\t\t\t\t\tup: 38,\r\n\t\t\t\t\t\t\t\t\tright: 39,\r\n\t\t\t\t\t\t\t\t\tdown: 40\r\n\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tswitch (keyCode) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tcase arrow.left :\r\n\r\n\t\t\t\t\t\t\t\t\t_onnavigate( 'prev' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tcase arrow.right :\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t_onnavigate( 'next' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( Gamma.settings.swipe ) {\r\n\r\n\t\t\t\t\t\tGamma.singleview.on( {\r\n\t\t\t\t\t\t\t'swipeleft.gamma' : function() {\r\n\r\n\t\t\t\t\t\t\t\t_onnavigate( 'next' );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t'swiperight.gamma' : function() {\r\n\r\n\t\t\t\t\t\t\t\t_onnavigate( 'prev' );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tGamma.svplay.on( 'click.gamma', function() {\r\n\r\n\t\t\t\t\t\tif( Gamma.slideshow ) {\r\n\r\n\t\t\t\t\t\t\t_stopSlideshow();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if( !Gamma.isAnimating ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_prepareSlideshow();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\t// sets a transition for an element\r\n\t\t_setTransition = function( el , property, speed, easing ) {\r\n\r\n\t\t\tif( !property ) {\r\n\r\n\t\t\t\tproperty = 'all';\r\n\r\n\t\t\t}\r\n\t\t\tif( !speed ) {\r\n\r\n\t\t\t\tspeed = Gamma.settings.speed;\r\n\r\n\t\t\t}\r\n\t\t\tif( !easing ) {\r\n\r\n\t\t\t\teasing = Gamma.settings.easing;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tel.css( 'transition', property + ' ' + speed + 'ms ' + easing );\r\n\r\n\t\t},\r\n\t\t// apply a transition or fallback to jquery animate based on condition (cond)\r\n\t\t_applyAnimation = function( el, styleCSS, speed, cond, fncomplete ) {\r\n\r\n\t\t\t$.fn.applyStyle = cond ? $.fn.css : $.fn.animate;\r\n\r\n\t\t\tif( fncomplete && cond ) {\r\n\r\n\t\t\t\tel.on( transEndEventName, fncomplete );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfncomplete = fncomplete || function() { return false; };\r\n\r\n\t\t\tel.stop().applyStyle( styleCSS, $.extend( true, [], { duration : speed + 'ms', complete : fncomplete } ) );\r\n\r\n\t\t},\r\n\t\t// public method: adds more items\r\n\t\tadd = function( $newitems ) {\r\n\r\n\t\t\tGamma.gallery.append( $newitems );\r\n\t\t\tGamma.items = Gamma.gallery.children();\r\n\t\t\tGamma.itemsCount = Gamma.items.length;\r\n\t\t\t_layout( $newitems );\r\n\t\t\t_reloadMasonry();\r\n\r\n\t\t};\r\n\r\n\treturn {\r\n\t\tinit : init,\r\n\t\tadd : add\r\n\t}\r\n\r\n})();"],"names":["getHiddenProp","prefixes","document","i","length","isHidden","prop","String","prototype","queryStringToJSON","params","this","substring","indexOf","replace","eval","decodeURIComponent","split","json","n","param","key","value","e","keys","path","cmd","$","each","ii","jsonCLOSUREGLOBAL","valueCLOSUREGLOBAL","extend","expr","inViewport","el","scrollTop","documentElement","body","elOffsetTop","offset","top","elH","height","winH","window","innerHeight","Gamma","_saveState","id","settings","historyapi","undefined","History","pushState","url","getState","isSV","_goto","_reloadMasonry","timeout","clearTimeout","masonrytimeout","setTimeout","gallery","masonry","_toggleControl","$control","status","animStyle","css","show","hide","_onnavigate","dir","slideshow","_navigate","_resize","_setMasonry","_resizeGrid","_svResizeImage","$window","$body","$document","Modernizr","transEndEventName","WebkitTransition","MozTransition","OTransition","msTransition","transition","prefixed","defaults","columns","speed","easing","overlayAnimated","nextOnClickImage","circular","svImageTransitionSpeedFade","svImageTransitionEasingFade","svImageTransitionSpeedResize","svImageTransitionEasingResize","svMarginsVH","vertical","horizontal","keyboard","swipe","interval","_config","container","overlay","find","controls","children","items","itemsCount","isAnimating","svMargins","enabled","supportTransitions","csstransitions","_createSingleViewNavigation","svplay","insertAfter","svclose","nav","appendTo","singleview","svnavnext","svnavprev","_initEvents","anim","$item","isSingleview","_closesingleview","eq","Math","abs","svImage","_setTransition","_applyAnimation","opacity","remove","_singleviewitem","svDescription","empty","_layout","$items","$picEl","sources","_getImgSources","source","_chooseImgSource","outerWidth","description","data","maxwidth","maxheight","addClass","html","attr","alt","title","src","$el","theSources","$source","push","width","pos","containerW","viewport","len","floor","_initMasonry","callback","imagesLoaded","itemSelector","columnWidth","containerWidth","call","w","current","finalConfig","_getFinalImgConfig","imgMaxW","imgMaxH","wrapper","image","finalSizePosition","currentSrc","finalStyle","left","h","l","t","off","position","load","$img","next","insertBefore","properties","ratio","_getFinalSizePosition","checksource","_singleview","index","fly","outerHeight","styleCSS","cond","style","display","offsetHeight","scrollLeft","_loadSVItemFromGrid","wrap","loadingtimeout","removeClass","$this","imageSize","wrapperSize","finalH","finalW","imgW","imgH","wrapperW","wrapperH","_stopSlideshow","not","diff","wst","is","zIndex","_visChange","_prepareSlideshow","slideshowtimeout","right","_startSlideshow","_preloadNext","pause","type","on","evtname","visProp","addEventListener","event","keyCode","which","swipeleft.gamma","swiperight.gamma","property","fncomplete","fn","applyStyle","animate","stop","duration","complete","add","$newitems","append","init"],"mappings":"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"}